name: CI

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build:
    runs-on: ubuntu-latest
    container: debian:testing-slim
    
    steps:
    # Checks-out under $GITHUB_WORKSPACE
    - uses: actions/checkout@v2
    
    - name: Install Dependencies
      run: |
        apt-get update
        apt-get install --assume-yes --no-install-recommends \
          debconf \
          build-essential \
          cmake \
          make \
          gcc \
          g++ \
          git \
          help2man \
          pandoc \
          libboost-date-time-dev \
          libboost-iostreams-dev \
          libboost-program-options-dev \
          libboost-system-dev \
          libboost-test-dev \
          libpqxx-dev \
          libpugixml-dev \
          libpcap0.8-dev \
          python
          
    - name: Version Checks
      run: |
        printf "System info"
        uname -a
        
        printf "\nApt Cache libpqxx"
        apt-cache search libpqxx
        
        printf "\ng++ version"
        g++ --version
        
        printf "\ncmake version"
        cmake --version

    - name: Configure
      run: cmake
        -DCMAKE_CXX_COMPILER=g++-9
        -DCMAKE_C_COMPILER=gcc-9
        -DBOOST_ROOT=$BOOST_ROOT_1_69_0
        -DBoost_ADDITIONAL_VERSIONS=1.69.0
        -DBoost_ARCHITECTURE=-x64
        -DBoost_USE_MULTITHREADED=ON
        -S . -B build
    
    - name: Build
      run: cmake --build build
