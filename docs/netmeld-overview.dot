digraph netmeld {
  rankdir=LR;
  nodesep=0.75;
  ranksep=0.75;
  newrank=true;
  splines=spline;
  compound=true;
  concentrate=true;

  label="Netmeld Tool Suite 2.x -- General Dataflow Overview";


  subgraph cluster_sources {
    label="Data Sources";
    rank=same;
    node [shape=note];
    srcTargeted [label="Targeted\nConfiguration\nSettings"];
    srcConfigs [label="Configuration\nFiles"];
    srcNetwork [label="Network\nCollection"];
    srcOther [label="\"Other\"\nManually\nCollected\Data"];
  }


  // Modules
  node [shape=rectangle];
  {
    rank=same;
    datalake [label="Datalake"];
    datastore [label="Datastore"];
  }
  {
    rank=same;
    fetchers [label="Fetchers"];
    playbook [label="Playbook"];
    tool_clw [label="Command\nLine\nWrapper"];
  }


  subgraph cluster_artifacts {
    label="Collection Artifacts";
    rank=same;
    node [shape=note];
    artConfigs [label="Aggregated\nConfiguration\nArtifacts"];
    artGraphs [label="Topology\nGraphs"];
    artReports [label="Formatted\nReports"];
    artArbitrary [label="Arbitrary\nRaw\nData"];
    artTargeted [label="Targeted\nRaw\nData"];
  }


  // Source to modules
  srcTargeted->{datastore playbook};
  srcConfigs->{datastore fetchers};
  srcNetwork->{datastore playbook};
  srcOther->{datalake tool_clw};

  // Module to modules
  // -- loose coupling
  datalake->datastore [style="dashed"];
  fetchers->datalake [style="dashed"];
  tool_clw->datastore [style="dashed"];
  // -- hard coupling
  playbook->datastore [dir="both"];
  playbook->tool_clw;

  // Module to artifacts
  datastore->{artConfigs artGraphs artReports artTargeted};
  datalake->{artArbitrary};
  fetchers->{artArbitrary};
  playbook->{artArbitrary};
  tool_clw->{artArbitrary};
}
