<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="1656pt" height="1938pt"
 viewBox="0.00 0.00 1656.00 1938.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1934)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1934 1652,-1934 1652,4 -4,4"/>
<text text-anchor="start" x="579" y="-1913.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Example: Playbook Intra&#45;Network Execution Process (Default)</text>
<text text-anchor="start" x="440" y="-1894.8" font-family="Times,serif" font-size="14.00">Assume:</text>
<text text-anchor="start" x="440" y="-1876.8" font-family="liberation mono" font-size="14.00"> &#160;psql site &#45;c &quot;insert into playbook_roe_ip_nets values (&#39;1.2.3.0/24&#39;, true)&quot;</text>
<text text-anchor="start" x="440" y="-1861.8" font-family="liberation mono" font-size="14.00"> &#160;nmdb&#45;playbook&#45;insert&#45;source &#45;&#45;intra&#45;network &#45;&#45;interface eth0 &#45;&#45;ip&#45;addr 1.2.3.4/24 &#45;&#45;stage 1</text>
<text text-anchor="start" x="440" y="-1843.8" font-family="Times,serif" font-size="14.00">Execution:</text>
<text text-anchor="start" x="440" y="-1825.8" font-family="liberation mono" font-size="14.00"> &#160;nmdb&#45;playbook &#45;&#45;intra&#45;network &#45;&#45;execute</text>
<!-- pre_phase -->
<g id="node1" class="node">
<title>pre_phase</title>
<path fill="none" stroke="black" d="M1230.5,-1816C1230.5,-1816 417.5,-1816 417.5,-1816 411.5,-1816 405.5,-1810 405.5,-1804 405.5,-1804 405.5,-1630 405.5,-1630 405.5,-1624 411.5,-1618 417.5,-1618 417.5,-1618 1230.5,-1618 1230.5,-1618 1236.5,-1618 1242.5,-1624 1242.5,-1630 1242.5,-1630 1242.5,-1804 1242.5,-1804 1242.5,-1810 1236.5,-1816 1230.5,-1816"/>
<text text-anchor="start" x="787" y="-1791.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Pre&#45;Phase</text>
<text text-anchor="start" x="440.5" y="-1761.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Configure NIC for stage; passive listen</text>
<text text-anchor="start" x="424" y="-1747.8" font-family="liberation mono" font-size="14.00">sysctl &#45;q &#45;w net.ipv6.conf.eth0.autoconf=0</text>
<text text-anchor="start" x="424" y="-1733.8" font-family="liberation mono" font-size="14.00">sysctl &#45;q &#45;w net.ipv6.conf.eth0.accept_ra=0</text>
<text text-anchor="start" x="424" y="-1719.8" font-family="liberation mono" font-size="14.00">ip link set dev eth0 up</text>
<text text-anchor="start" x="424" y="-1705.8" font-family="liberation mono" font-size="14.00">sleep 1s</text>
<text text-anchor="start" x="424" y="-1691.8" font-family="liberation mono" font-size="14.00">clw dumpcap &#45;i eth0 &#45;a duration:300</text>
<text text-anchor="start" x="424" y="-1677.8" font-family="liberation mono" font-size="14.00">ip link set dev eth0 down</text>
<text text-anchor="start" x="424" y="-1663.8" font-family="liberation mono" font-size="14.00">sleep 0.5s</text>
<text text-anchor="start" x="794" y="-1692" font-family="liberation mono" font-size="100.00">→</text>
<text text-anchor="start" x="870" y="-1761.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Configure NIC for phases; non&#45;portfast wait</text>
<text text-anchor="start" x="870" y="-1747.8" font-family="liberation mono" font-size="14.00">sysctl &#45;q &#45;w net.ipv6.conf.eth0.autoconf=0</text>
<text text-anchor="start" x="870" y="-1733.8" font-family="liberation mono" font-size="14.00">sysctl &#45;q &#45;w net.ipv6.conf.eth0.accept_ra=0</text>
<text text-anchor="start" x="870" y="-1719.8" font-family="liberation mono" font-size="14.00">ip link set dev eth0 up</text>
<text text-anchor="start" x="870" y="-1705.8" font-family="liberation mono" font-size="14.00">sleep 1s</text>
<text text-anchor="start" x="870" y="-1691.8" font-family="liberation mono" font-size="14.00">clw dumpcap &#45;i eth0 &#45;a duration:90</text>
<text text-anchor="start" x="870" y="-1677.8" font-family="liberation mono" font-size="14.00">sysctl &#45;q &#45;w net.ipv6.conf.eth0.autoconf=1</text>
<text text-anchor="start" x="870" y="-1663.8" font-family="liberation mono" font-size="14.00">sysctl &#45;q &#45;w net.ipv6.conf.eth0.accept_ra=1</text>
<text text-anchor="start" x="870" y="-1649.8" font-family="liberation mono" font-size="14.00">ip addr add 1.2.3.4/24 dev eth0</text>
<text text-anchor="start" x="870" y="-1635.8" font-family="liberation mono" font-size="14.00">sleep 0.5s</text>
</g>
<!-- phase1 -->
<g id="node2" class="node">
<title>phase1</title>
<path fill="none" stroke="black" d="M1032.5,-1564C1032.5,-1564 615.5,-1564 615.5,-1564 609.5,-1564 603.5,-1558 603.5,-1552 603.5,-1552 603.5,-1406 603.5,-1406 603.5,-1400 609.5,-1394 615.5,-1394 615.5,-1394 1032.5,-1394 1032.5,-1394 1038.5,-1394 1044.5,-1400 1044.5,-1406 1044.5,-1406 1044.5,-1552 1044.5,-1552 1044.5,-1558 1038.5,-1564 1032.5,-1564"/>
<text text-anchor="start" x="795.5" y="-1539.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Phase 1</text>
<text text-anchor="start" x="713" y="-1509.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Target Files (RoE excluded)</text>
<text text-anchor="start" x="622" y="-1495.8" font-family="liberation mono" font-size="14.00">psql &quot;dbname=site &quot; &#45;A &#45;t &#45;c</text>
<text text-anchor="start" x="622" y="-1481.8" font-family="liberation mono" font-size="14.00"> &#160;&quot; SELECT DISTINCT ip_net</text>
<text text-anchor="start" x="622" y="-1467.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;FROM playbook_roe_ip_nets</text>
<text text-anchor="start" x="622" y="-1453.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;WHERE (NOT in_scope)</text>
<text text-anchor="start" x="622" y="-1439.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;AND (4 = family(ip_net))</text>
<text text-anchor="start" x="622" y="-1425.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;ORDER BY ip_net &quot;</text>
<text text-anchor="start" x="622" y="-1411.8" font-family="liberation mono" font-size="14.00"> &#160;&gt;&gt; ~/.netmeld/playbook/DTS_UUID/RoE&#45;Exclude&#45;IPs</text>
</g>
<!-- pre_phase&#45;&gt;phase1 -->
<g id="edge1" class="edge">
<title>pre_phase&#45;&gt;phase1</title>
<path fill="none" stroke="black" d="M824,-1617.97C824,-1603.6 824,-1588.82 824,-1574.52"/>
<polygon fill="black" stroke="black" points="827.5,-1574.21 824,-1564.21 820.5,-1574.21 827.5,-1574.21"/>
</g>
<!-- phase2 -->
<g id="node3" class="node">
<title>phase2</title>
<path fill="none" stroke="black" d="M1326,-1340C1326,-1340 322,-1340 322,-1340 316,-1340 310,-1334 310,-1328 310,-1328 310,-1184 310,-1184 310,-1178 316,-1172 322,-1172 322,-1172 1326,-1172 1326,-1172 1332,-1172 1338,-1178 1338,-1184 1338,-1184 1338,-1328 1338,-1328 1338,-1334 1332,-1340 1326,-1340"/>
<text text-anchor="start" x="795" y="-1315.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Phase 2</text>
<text text-anchor="start" x="439.5" y="-1285.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Initial Host Discovery</text>
<text text-anchor="start" x="328" y="-1271.8" font-family="liberation mono" font-size="14.00">clw ping &#45;4 &#45;n &#45;I eth0 &#45;L &#45;c 4 &#45;b 1.2.3.255</text>
<text text-anchor="start" x="328" y="-1257.8" font-family="liberation mono" font-size="14.00">clw ping &#45;4 &#45;n &#45;I eth0 &#45;L &#45;c 4 &#45;b 255.255.255.255</text>
<text text-anchor="start" x="748" y="-1216" font-family="liberation mono" font-size="100.00">→</text>
<text text-anchor="start" x="923" y="-1285.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Host Discovery and IP Protocol Scans</text>
<text text-anchor="start" x="824" y="-1271.8" font-family="liberation mono" font-size="14.00">clw nmap &#45;T4 &#45;n &#45;e eth0 &#45;PR &#45;sn &#45;&#45;script &#39;(ip&#45;forwarding)&#39;</text>
<text text-anchor="start" x="824" y="-1257.8" font-family="liberation mono" font-size="14.00"> &#160;1.2.3.0/24</text>
<text text-anchor="start" x="824" y="-1243.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;excludefile ~/.netmeld/playbook/DTS_UUID/RoE&#45;Exclude&#45;IPs</text>
<text text-anchor="start" x="824" y="-1229.8" font-family="liberation mono" font-size="14.00">clw nmap &#45;T4 &#45;n &#45;e eth0 &#45;PR &#45;sO</text>
<text text-anchor="start" x="824" y="-1215.8" font-family="liberation mono" font-size="14.00"> &#160;1.2.3.0/24</text>
<text text-anchor="start" x="824" y="-1201.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;excludefile ~/.netmeld/playbook/DTS_UUID/RoE&#45;Exclude&#45;IPs</text>
</g>
<!-- phase1&#45;&gt;phase2 -->
<g id="edge2" class="edge">
<title>phase1&#45;&gt;phase2</title>
<path fill="none" stroke="black" d="M824,-1393.82C824,-1379.68 824,-1364.94 824,-1350.59"/>
<polygon fill="black" stroke="black" points="827.5,-1350.22 824,-1340.22 820.5,-1350.22 827.5,-1350.22"/>
</g>
<!-- phase3 -->
<g id="node4" class="node">
<title>phase3</title>
<path fill="none" stroke="black" d="M1078,-1118C1078,-1118 570,-1118 570,-1118 564,-1118 558,-1112 558,-1106 558,-1106 558,-1016 558,-1016 558,-1010 564,-1004 570,-1004 570,-1004 1078,-1004 1078,-1004 1084,-1004 1090,-1010 1090,-1016 1090,-1016 1090,-1106 1090,-1106 1090,-1112 1084,-1118 1078,-1118"/>
<text text-anchor="start" x="795" y="-1093.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Phase 3</text>
<text text-anchor="start" x="708" y="-1063.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Default DNS Lookup With Nmap</text>
<text text-anchor="start" x="576" y="-1049.8" font-family="liberation mono" font-size="14.00">clw nmap &#45;T4 &#45;R &#45;e eth0 &#45;sL &#45;&#45;resolve&#45;all</text>
<text text-anchor="start" x="576" y="-1035.8" font-family="liberation mono" font-size="14.00"> &#160;1.2.3.0/24</text>
<text text-anchor="start" x="576" y="-1021.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;excludefile ~/.netmeld/playbook/DTS_UUID/RoE&#45;Exclude&#45;IPs</text>
</g>
<!-- phase2&#45;&gt;phase3 -->
<g id="edge3" class="edge">
<title>phase2&#45;&gt;phase3</title>
<path fill="none" stroke="black" d="M824,-1171.75C824,-1157.22 824,-1142.28 824,-1128.28"/>
<polygon fill="black" stroke="black" points="827.5,-1128.28 824,-1118.28 820.5,-1128.28 827.5,-1128.28"/>
</g>
<!-- phase4 -->
<g id="node5" class="node">
<title>phase4</title>
<path fill="none" stroke="black" d="M1636,-950C1636,-950 12,-950 12,-950 6,-950 0,-944 0,-938 0,-938 0,-652 0,-652 0,-646 6,-640 12,-640 12,-640 1636,-640 1636,-640 1642,-640 1648,-646 1648,-652 1648,-652 1648,-938 1648,-938 1648,-944 1642,-950 1636,-950"/>
<text text-anchor="start" x="795" y="-925.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Phase 4</text>
<text text-anchor="start" x="109" y="-895.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Target Files (Responding Hosts)</text>
<text text-anchor="start" x="18" y="-881.8" font-family="liberation mono" font-size="14.00">psql &quot;dbname=site &quot; &#45;A &#45;t &#45;c</text>
<text text-anchor="start" x="18" y="-867.8" font-family="liberation mono" font-size="14.00"> &#160;&quot; SELECT DISTINCT ia.ip_addr</text>
<text text-anchor="start" x="18" y="-853.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;FROM raw_ip_addrs AS ia</text>
<text text-anchor="start" x="18" y="-839.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;JOIN tool_runs AS tr</text>
<text text-anchor="start" x="18" y="-825.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;ON (ia.tool_run_id = tr.id)</text>
<text text-anchor="start" x="18" y="-811.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;JOIN playbook_roe_ip_nets AS roe</text>
<text text-anchor="start" x="18" y="-797.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;ON (ia.ip_addr &lt;&lt;= roe.ip_net)</text>
<text text-anchor="start" x="18" y="-783.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;WHERE (ia.is_responding)</text>
<text text-anchor="start" x="18" y="-769.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;AND (4 = family(ia.ip_addr))</text>
<text text-anchor="start" x="18" y="-755.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;AND (roe.in_scope)</text>
<text text-anchor="start" x="18" y="-741.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;AND (ia.ip_addr &lt;&lt;= &#39;1.2.3.0/24&#39;)</text>
<text text-anchor="start" x="18" y="-727.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;ORDER BY ia.ip_addr &quot;</text>
<text text-anchor="start" x="18" y="-713.8" font-family="liberation mono" font-size="14.00"> &#160;&gt;&gt; ~/.netmeld/playbook/DTS_UUID/Responding&#45;Host&#45;IPs</text>
<text text-anchor="start" x="471" y="-755" font-family="liberation mono" font-size="100.00">→</text>
<text text-anchor="start" x="638" y="-895.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Port Scans (plus basic info gathering)</text>
<text text-anchor="start" x="547" y="-881.8" font-family="liberation mono" font-size="14.00">clw nmap &#45;T4 &#45;n &#45;e eth0 &#45;PR &#45;Pn &#45;O</text>
<text text-anchor="start" x="547" y="-867.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;script &#39;(banner or dns&#45;nsid or ntp&#45;info or rpcinfo</text>
<text text-anchor="start" x="547" y="-853.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;or ssh&#45;hostkey or ssh2&#45;enum&#45;algos or ssl&#45;cert</text>
<text text-anchor="start" x="547" y="-839.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;or smtp&#45;commands or smb&#45;os&#45;discovery or smbv2&#45;enabled</text>
<text text-anchor="start" x="547" y="-825.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;or vnc&#45;info)&#39;</text>
<text text-anchor="start" x="547" y="-811.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;sS &#45;p `nmdb&#45;export&#45;port&#45;list &#45;&#45;tcp&#45;all`</text>
<text text-anchor="start" x="547" y="-797.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;iL ~/.netmeld/playbook/DTS_UUID/Responding&#45;Host&#45;IPs</text>
<text text-anchor="start" x="547" y="-783.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;excludefile ~/.netmeld/playbook/DTS_UUID/RoE&#45;Exclude&#45;IPs</text>
<text text-anchor="start" x="547" y="-755.8" font-family="liberation mono" font-size="14.00">clw nmap &#45;T4 &#45;n &#45;e eth0 &#45;PR &#45;Pn &#45;O</text>
<text text-anchor="start" x="547" y="-741.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;script &#39;(banner or dns&#45;nsid or ntp&#45;info or rpcinfo</text>
<text text-anchor="start" x="547" y="-727.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;or ssh&#45;hostkey or ssh2&#45;enum&#45;algos or ssl&#45;cert</text>
<text text-anchor="start" x="547" y="-713.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;or smtp&#45;commands or smb&#45;os&#45;discovery or smbv2&#45;enabled</text>
<text text-anchor="start" x="547" y="-699.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;or vnc&#45;info)&#39;</text>
<text text-anchor="start" x="547" y="-685.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;sU &#45;p `nmdb&#45;export&#45;port&#45;list &#45;&#45;udp`</text>
<text text-anchor="start" x="547" y="-671.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;iL ~/.netmeld/playbook/DTS_UUID/Responding&#45;Host&#45;IPs</text>
<text text-anchor="start" x="547" y="-657.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;excludefile ~/.netmeld/playbook/DTS_UUID/RoE&#45;Exclude&#45;IPs</text>
<text text-anchor="start" x="1058" y="-755" font-family="liberation mono" font-size="100.00">→</text>
<text text-anchor="start" x="1233" y="-895.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Service Scans (most scripts enabled)</text>
<text text-anchor="start" x="1134" y="-881.8" font-family="liberation mono" font-size="14.00">clw nmap &#45;T4 &#45;n &#45;e eth0 &#45;PR &#45;A</text>
<text text-anchor="start" x="1134" y="-867.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;script &#39;((default or discovery) and not (external</text>
<text text-anchor="start" x="1134" y="-853.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;or brute or dos))&#39;</text>
<text text-anchor="start" x="1134" y="-839.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;sS &#45;p `nmdb&#45;export&#45;port&#45;list &#45;&#45;from&#45;db &#45;&#45;tcp`</text>
<text text-anchor="start" x="1134" y="-825.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;iL ~/.netmeld/playbook/DTS_UUID/Responding&#45;Host&#45;IPs</text>
<text text-anchor="start" x="1134" y="-811.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;excludefile ~/.netmeld/playbook/DTS_UUID/RoE&#45;Exclude&#45;IPs</text>
</g>
<!-- phase3&#45;&gt;phase4 -->
<g id="edge4" class="edge">
<title>phase3&#45;&gt;phase4</title>
<path fill="none" stroke="black" d="M824,-1003.69C824,-990.46 824,-975.7 824,-960.31"/>
<polygon fill="black" stroke="black" points="827.5,-960.12 824,-950.12 820.5,-960.12 827.5,-960.12"/>
</g>
<!-- phase5 -->
<g id="node6" class="node">
<title>phase5</title>
<path fill="none" stroke="black" d="M1400,-586C1400,-586 248,-586 248,-586 242,-586 236,-580 236,-574 236,-574 236,-430 236,-430 236,-424 242,-418 248,-418 248,-418 1400,-418 1400,-418 1406,-418 1412,-424 1412,-430 1412,-430 1412,-574 1412,-574 1412,-580 1406,-586 1400,-586"/>
<text text-anchor="start" x="795" y="-561.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Phase 5</text>
<text text-anchor="start" x="369.5" y="-531.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Target Files (DNS servers)</text>
<text text-anchor="start" x="254" y="-517.8" font-family="liberation mono" font-size="14.00">psql &#45;R, &quot;dbname=site &quot; &#45;A &#45;t &#45;c</text>
<text text-anchor="start" x="254" y="-503.8" font-family="liberation mono" font-size="14.00"> &#160;&quot; SELECT DISTINCT host(ip_addr)</text>
<text text-anchor="start" x="254" y="-489.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;FROM ports_services</text>
<text text-anchor="start" x="254" y="-475.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;WHERE port = &#39;53&#39;</text>
<text text-anchor="start" x="254" y="-461.8" font-family="liberation mono" font-size="14.00"> &#160;&#160;&#160;&#160;&#160;AND port_state = &#39;open&#39; &quot;</text>
<text text-anchor="start" x="254" y="-447.8" font-family="liberation mono" font-size="14.00"> &#160;&gt;&gt; ~/.netmeld/playbook/DTS_UUID/Possible&#45;DNS&#45;Servers</text>
<text text-anchor="start" x="715" y="-462" font-family="liberation mono" font-size="100.00">→</text>
<text text-anchor="start" x="976.5" y="-531.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Learned DNS Lookup With Nmap</text>
<text text-anchor="start" x="791" y="-517.8" font-family="liberation mono" font-size="14.00">clw nmap &#45;T4 &#45;R &#45;e eth0 &#45;sL &#45;&#45;resolve&#45;all</text>
<text text-anchor="start" x="791" y="-503.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;dns&#45;servers $(cat ~/.netmeld/playbook/DTS_UUID/Possible&#45;DNS&#45;Servers )</text>
<text text-anchor="start" x="791" y="-489.8" font-family="liberation mono" font-size="14.00"> &#160;1.2.3.0/24</text>
<text text-anchor="start" x="791" y="-475.8" font-family="liberation mono" font-size="14.00"> &#160;&#45;&#45;excludefile ~/.netmeld/playbook/DTS_UUID/RoE&#45;Exclude&#45;IPs</text>
</g>
<!-- phase4&#45;&gt;phase5 -->
<g id="edge5" class="edge">
<title>phase4&#45;&gt;phase5</title>
<path fill="none" stroke="black" d="M824,-639.98C824,-625.06 824,-610.26 824,-596.21"/>
<polygon fill="black" stroke="black" points="827.5,-596.12 824,-586.12 820.5,-596.12 827.5,-596.12"/>
</g>
<!-- phase6 -->
<g id="node7" class="node">
<title>phase6</title>
<path fill="none" stroke="black" d="M1127.5,-364C1127.5,-364 520.5,-364 520.5,-364 514.5,-364 508.5,-358 508.5,-352 508.5,-352 508.5,-234 508.5,-234 508.5,-228 514.5,-222 520.5,-222 520.5,-222 1127.5,-222 1127.5,-222 1133.5,-222 1139.5,-228 1139.5,-234 1139.5,-234 1139.5,-352 1139.5,-352 1139.5,-358 1133.5,-364 1127.5,-364"/>
<text text-anchor="start" x="795.5" y="-339.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Phase 6</text>
<text text-anchor="start" x="737.5" y="-309.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Manual Testing Prompt</text>
<text text-anchor="start" x="527" y="-295.8" font-family="liberation mono" font-size="14.00">echo &#39;&#39;;</text>
<text text-anchor="start" x="527" y="-281.8" font-family="liberation mono" font-size="14.00">echo &#39;Finish any manual testing that is using eth0 1.2.3.4/24.&#39;;</text>
<text text-anchor="start" x="527" y="-267.8" font-family="liberation mono" font-size="14.00">echo &#39;Close this xterm when manual testing is complete.&#39;;</text>
<text text-anchor="start" x="527" y="-253.8" font-family="liberation mono" font-size="14.00">echo &#39;When this xterm is closed, eth0 1.2.3.4/24 will be deconfigured.&#39;;</text>
<text text-anchor="start" x="527" y="-239.8" font-family="liberation mono" font-size="14.00">while [[ 1 == 1 ]]; do sleep 600; done;</text>
</g>
<!-- phase5&#45;&gt;phase6 -->
<g id="edge6" class="edge">
<title>phase5&#45;&gt;phase6</title>
<path fill="none" stroke="black" d="M824,-418C824,-403.61 824,-388.66 824,-374.35"/>
<polygon fill="black" stroke="black" points="827.5,-374.05 824,-364.05 820.5,-374.05 827.5,-374.05"/>
</g>
<!-- post_phase -->
<g id="node8" class="node">
<title>post_phase</title>
<path fill="none" stroke="black" d="M1156.5,-168C1156.5,-168 491.5,-168 491.5,-168 485.5,-168 479.5,-162 479.5,-156 479.5,-156 479.5,-12 479.5,-12 479.5,-6 485.5,0 491.5,0 491.5,0 1156.5,0 1156.5,0 1162.5,0 1168.5,-6 1168.5,-12 1168.5,-12 1168.5,-156 1168.5,-156 1168.5,-162 1162.5,-168 1156.5,-168"/>
<text text-anchor="start" x="783" y="-143.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Post&#45;Phase</text>
<text text-anchor="start" x="572" y="-113.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Deconfigure NIC for phase</text>
<text text-anchor="start" x="498" y="-99.8" font-family="liberation mono" font-size="14.00">ip addr del 1.2.3.4/24 dev eth0</text>
<text text-anchor="start" x="498" y="-85.8" font-family="liberation mono" font-size="14.00">sysctl &#45;q &#45;w net.ipv6.conf.eth0.accept_ra=0</text>
<text text-anchor="start" x="498" y="-71.8" font-family="liberation mono" font-size="14.00">sysctl &#45;q &#45;w net.ipv6.conf.eth0.autoconf=0</text>
<text text-anchor="start" x="498" y="-57.8" font-family="liberation mono" font-size="14.00">sleep 0.5s</text>
<text text-anchor="start" x="868" y="-44" font-family="liberation mono" font-size="100.00">→</text>
<text text-anchor="start" x="944" y="-113.8" font-family="liberation mono" font-weight="bold" font-size="14.00">Deconfigure NIC for stage</text>
<text text-anchor="start" x="944" y="-99.8" font-family="liberation mono" font-size="14.00">ip link set dev eth0 down</text>
<text text-anchor="start" x="944" y="-85.8" font-family="liberation mono" font-size="14.00">sleep 0.5s</text>
</g>
<!-- phase6&#45;&gt;post_phase -->
<g id="edge7" class="edge">
<title>phase6&#45;&gt;post_phase</title>
<path fill="none" stroke="black" d="M824,-221.92C824,-207.91 824,-192.99 824,-178.34"/>
<polygon fill="black" stroke="black" points="827.5,-178.25 824,-168.25 820.5,-178.25 827.5,-178.25"/>
</g>
</g>
</svg>
